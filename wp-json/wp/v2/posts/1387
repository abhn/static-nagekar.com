{"id":1387,"date":"2022-04-18T16:40:00","date_gmt":"2022-04-18T14:40:00","guid":{"rendered":"https:\/\/www.nagekar.com\/?p=1387"},"modified":"2022-04-18T22:15:03","modified_gmt":"2022-04-18T20:15:03","slug":"wordpress-security-checklist","status":"publish","type":"post","link":"https:\/\/nagekar.com\/2022\/04\/wordpress-security-checklist.html","title":{"rendered":"WordPress Security Checklist: How To Secure Your WordPress Website"},"content":{"rendered":"\n<p>WordPress has been powering my blog <a href=\"https:\/\/www.nagekar.com\/2021\/01\/life-goes-full-circle-blog-back-to-wordpress.html\">since the start of last year<\/a>. In fact, migrating my Jekyll template to WordPress was one of the highlights of my new year 2021 and I&#8217;m very happy that I did, although I didn&#8217;t publish as much as I had hoped for. Fortunately, I&#8217;ve learned a lot more about WordPress over the course of a year than when I started. In this short primer, I hope to go into a bit more depth on how to securely run a self hosted WordPress website.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\">Prerequisites<\/h2>\n\n\n\n<p>Before we get started, there are a few things that we need to make sure we have to<\/p>\n\n\n\n<ul class=\"wp-block-list\"><li>Self hosted WordPress installation with SSH access<\/li><li>Administrator account to set up plugins<\/li><\/ul>\n\n\n\n<h2 class=\"wp-block-heading\">Table of contents<\/h2>\n\n\n\n<ol class=\"wp-block-list\"><li><a href=\"#plugins\" data-type=\"internal\" data-id=\"#plugins\">Keep plugins to the minimum and up to date<\/a><\/li><li><a href=\"#file-permissions\">Fix file permissions<\/a><\/li><li><a href=\"http:\/\/tfa\">Two-Factor Authentication<\/a><\/li><li><a href=\"#failed-logins\">Set up auto banning of failed logins<\/a><\/li><li><a href=\"#regular-backups\">Enable regular backups<\/a><\/li><li><a href=\"http:\/\/xml-rpc\">Disable XML-RPC<\/a><\/li><li><a href=\"#file-editing\">Disable file editing in WordPress admin<\/a><\/li><li><a href=\"#waf\">Use a Web Application Firewall<\/a><\/li><li><a href=\"http:\/\/general-security\">Don&#8217;t forget the usual web security measures<\/a><\/li><\/ol>\n\n\n\n<h2 class=\"wp-block-heading\" id=\"plugins\">1. Keep plugins to the minimum and up to date<\/h2>\n\n\n\n<p>I wish I could just sticky something like this on top of most of my articles, but most people trying to attack our websites don&#8217;t have the time or resources to develop and use 0days. They use existing exploits out in the wild and some of these exploits can be months old, if not more. WordPress core and plugin authors can only do so much more than promptly releasing patches for security vulnerabilities that they find.<\/p>\n\n\n\n<p>So then it is up to us as site admins to make sure we patch as soon as is feasible. Having worked on many large codebases, I know automatic updating isn&#8217;t always possible or even desirable, but having an eye on the changelog can definitely help not get compromised.<\/p>\n\n\n\n<p>I&#8217;d also recommend a web security helper plugin that sends alert emails when it detects outdated plugins \/ themes \/ core.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\" id=\"file-permissions\">2. Fix file permissions<\/h2>\n\n\n\n<p>During development, many files and directories permissions are way too open to make it easy to set up the website and all plugins. In production, however, the permissions can be dialed down a notch to prevent anyone with any access on the server to take over the whole website.<\/p>\n\n\n\n<p>Similarly, attackers typically upload shell code using the uploads functionality, and if code execution is disabled in the directory, we make it harder for this attack to succeed.<\/p>\n\n\n\n<p>A detailed guide on setting file permissions can be found on official WordPress documentation: <a href=\"https:\/\/wordpress.org\/support\/article\/changing-file-permissions\/\">https:\/\/wordpress.org\/support\/article\/changing-file-permissions\/<\/a><\/p>\n\n\n\n<h2 class=\"wp-block-heading\" id=\"tfa\">3. Two-Factor Authentication<\/h2>\n\n\n\n<p>Administrator accounts have many powers on a WordPress website, and a compromised administrator account can lead to uploading of <a href=\"https:\/\/en.wikipedia.org\/wiki\/Shellcode\">PHP shell code<\/a> leading to command execution and server compromise.<\/p>\n\n\n\n<p>To make sure admin accounts are extra secure, enforce 2FA on all administrator accounts. This can be done by any <a href=\"https:\/\/wordpress.org\/plugins\/search\/2fa\/\">2FA or login security plugin<\/a> on the WordPress plugin store.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\" id=\"failed-logins\">4. Set up auto banning of failed logins<\/h2>\n\n\n\n<p>Since WordPress doesn&#8217;t ship with any builtin way of auto-banning failed login attempts, we have to rely on plugins like WordFence. WordFence will need to be configured with options to block login attempts after a certain number of failed attempts.<\/p>\n\n\n\n<figure class=\"wp-block-image\"><img loading=\"lazy\" decoding=\"async\" width=\"1024\" height=\"362\" src=\"https:\/\/www.nagekar.com\/wp-content\/uploads\/2022\/02\/2022-04-12_09-08-1024x362.png\" alt=\"\" class=\"wp-image-1519\" srcset=\"https:\/\/nagekar.com\/wp-content\/uploads\/2022\/02\/2022-04-12_09-08-1024x362.png 1024w, https:\/\/nagekar.com\/wp-content\/uploads\/2022\/02\/2022-04-12_09-08-300x106.png 300w, https:\/\/nagekar.com\/wp-content\/uploads\/2022\/02\/2022-04-12_09-08-768x272.png 768w, https:\/\/nagekar.com\/wp-content\/uploads\/2022\/02\/2022-04-12_09-08.png 1450w\" sizes=\"auto, (max-width: 1024px) 100vw, 1024px\" \/><\/figure>\n\n\n\n<p>WordFence can also help you disable execution in upload directories, block IP addresses making malicious requests and much more.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\" id=\"regular-backups\">5. Enable regular backups<\/h2>\n\n\n\n<p>While we can take preventive measures against mishaps, we can never be sure. Hence it is imperative that the website is backed up regularly. Backing up can be done at multiple places. The database can be backed up separately from the static assets and files. There are many plugins, like WPVivid, that help you fine tune what gets backed up and where it gets stored. It is always nice if you can afford an external backup location, like AWS S3.<\/p>\n\n\n\n<p>The hosting provider might also have ways of backing up the website. For example, AWS Lightsail has daily instance snapshots which backs up the entire disk.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\" id=\"xml-rpc\">6. Disable XML-RPC<\/h2>\n\n\n\n<p>If you don&#8217;t use plugins that rely on XML-RPC or using the WordPress mobile app, it is wise to disable XML-RPC which removes another widely used attack surface by attackers. Many plugins allow the disabling of XML-RPC, including the aforementioned WordFence.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\" id=\"file-editing\">7. Disable file editing in WordPress admin<\/h2>\n\n\n\n<p>Disable editing of files from WordPress admin as that&#8217;s almost never a good idea, especially if you can achieve the same using more secure methods like SSH. To disable file editor, simply add <\/p>\n\n\n\n<p><code>define( 'DISALLOW_FILE_EDIT', true );<\/code><\/p>\n\n\n\n<p>to your <code>wp-config.php<\/code> file.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\" id=\"waf\">8. Use a Web Application Firewall<\/h2>\n\n\n\n<p>A firewall plugin like <a href=\"https:\/\/sucuri.net\/\">Sucuri<\/a> or <a href=\"https:\/\/www.wordfence.com\">WordFence<\/a> can identify attack signatures and block malicious requests. Many also include IP address block lists that prevent known malicious IP addresses from reaching your WordPress website.<\/p>\n\n\n\n<p>For more control, there&#8217;s <a href=\"https:\/\/github.com\/SpiderLabs\/ModSecurity\">ModSecurity<\/a>. ModSecurity needs to be installed alongside the web server and it can detect and block known attack signatures for not just WordPress but just about any popular web framework. It does require a deeper technical know how to setup and maintain ModSecurity, and a plugin might work be a better approach for most people.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\" id=\"general-security\">9. Don&#8217;t forget the usual web security measures<\/h2>\n\n\n\n<p>A WordPress website is, at the end of it all, a website. While there are WordPress specific ways of hardening a WordPress installation, there is also a whole plethora of best practices that apply to every website, including the WordPress ones. <\/p>\n\n\n\n<ol class=\"wp-block-list\"><li><strong>Use HTTPS<\/strong> &#8211; SSL\/TLS certificates are free, and usually come by default with many hosting providers and CDNs. Don&#8217;t forget to turn it on and enforce it in strict mode.<\/li><li> <strong>Use appropriate security headers <\/strong>&#8211; Headers tell the browser how to handle your website&#8217;s content. Many client side attacks can be mitigated by using the right set of headers. A detailed list of useful headers can be found on OWASP&#8217;s website: <a href=\"https:\/\/owasp.org\/www-project-secure-headers\" target=\"_blank\" rel=\"noreferrer noopener\">https:\/\/owasp.org\/www-project-secure-headers<\/a><\/li><li><strong>Use CAPTCHA on login page<\/strong> &#8211; to prevent bot submissions and more sophisticated bruteforce attacks, enforce a CAPTCHA like reCaptcha on login page. WordFence supports this out of the box (needs an API key from Google). <\/li><li><strong>Handle user input with care when using a custom theme<\/strong> &#8211; when using a custom theme that accepts user input in the form of query parameters to show filtered content, the regular best practices around user generated input has to be followed. Embedding user input in output can lead to Cross Site Scripting, while passing it straight to the database can lead to SQL Injection.<\/li><\/ol>\n\n\n\n<h2 class=\"wp-block-heading\">In conclusion<\/h2>\n\n\n\n<p>I hope that was useful. If you have any questions around WordPress or suggestions to improve this article, feel free to reach out to me via email. Thank you for reading!<\/p>\n","protected":false},"excerpt":{"rendered":"<p>WordPress has been powering my blog since the start of last year. In fact, migrating my Jekyll template to WordPress was one of the highlights of my new year 2021 and I&#8217;m very happy that I did, although I didn&#8217;t publish as much as I had hoped for. Fortunately, I&#8217;ve learned a lot more about [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[1],"tags":[203,29,197],"class_list":["post-1387","post","type-post","status-publish","format-standard","hentry","category-uncategorized","tag-security","tag-web","tag-wordpress"],"_links":{"self":[{"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/posts\/1387","targetHints":{"allow":["GET"]}}],"collection":[{"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/comments?post=1387"}],"version-history":[{"count":10,"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/posts\/1387\/revisions"}],"predecessor-version":[{"id":1532,"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/posts\/1387\/revisions\/1532"}],"wp:attachment":[{"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/media?parent=1387"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/categories?post=1387"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/tags?post=1387"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}