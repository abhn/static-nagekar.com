{"id":1066,"date":"2018-08-11T22:00:00","date_gmt":"2018-08-11T22:00:00","guid":{"rendered":"http:\/\/wp.nagekar.com\/2018\/08\/11\/overthewire-bandit-27-33\/"},"modified":"2018-08-11T22:00:00","modified_gmt":"2018-08-11T22:00:00","slug":"overthewire-bandit-27-33","status":"publish","type":"post","link":"https:\/\/nagekar.com\/2018\/08\/overthewire-bandit-27-33.html","title":{"rendered":"OverTheWire Bandit 27-33 Write-up"},"content":{"rendered":"<p>\n  The last part of the Bandit challenges was relatively easy with most of the flags attainable with basic git knowledge, except for the last restricted shell escape. Try them here: <a href=\"https:\/\/overthewire.org\/wargames\/bandit\/bandit28.html\">OverTheWire Bandit<\/a>\n<\/p>\n<h3>Bandit 27-28<\/h3>\n<p>\n  This is as simple as it can get at this stage. Just clone the repo and <code>cat<\/code> the README.md file. The flag is in plaintext.\n<\/p>\n<h3>Bandit 28-29<\/h3>\n<p>\n  In this stage, if you <code>cat<\/code> the README.md file, you&#8217;ll find <code>xxxxxxx<\/code> in the place of the flag. If you do a <code>git log<\/code>, you&#8217;ll see that the password was entered and then removed. Just checkout the previous commit with <code>git checkout {hash}<\/code> and you&#8217;ll have your flag in the README.md\n<\/p>\n<h3>Bandit 29-30<\/h3>\n<p>\n  There&#8217;s no commit history this time, and the README.md file says &#8220;no password in production&#8221;, which is a clue. Do a <code>git branch -r<\/code> and you&#8217;ll see a development branch. Checkout into it (<code>git checkout dev<\/code>). <code>cat README.md<\/code> in this branch to get the flag.\n<\/p>\n<h3>Bandit 30-31<\/h3>\n<p>\n  No password in previous commits or branches here. But if you do a <code>git tag<\/code>, you&#8217;ll see a tag called &#8220;secret&#8221;. Do a <code>git show secret<\/code> and you have your flag.\n<\/p>\n<h3>Bandit 31-32<\/h3>\n<p>\n  Add and commit any random file, remove the wildcard entry from <code>.gitignore<\/code> and push origin. The flag is in the verbose output of the commit.\n<\/p>\n<h3>Bandit 32-33<\/h3>\n<p>\n  This is a restricted terminal escape challenge, very interesting. I urge you to think of creative ways of loopholing this before looking at the solution.\n<\/p>\n<p>\n  So the terminal converts every command into uppercase before executing. So <code>ls<\/code> becomes <code>LS<\/code> and <code>cd<\/code> becomes <code>CD<\/code> and nothing works.\n<\/p>\n<p>\n  One way of loopholing this behavior was symlinking a helper binary to an all caps name. I choose vim for the purpose, but cat, less or more, anything would&#8217;ve worked. Symlink the binary in your temp directory in some all caps name.\n<\/p>\n<pre>$ ln -s \/usr\/bin\/vim \/tmp\/mytempdir\/VIM<\/pre>\n<p>\n  Now, simply running <code>.\/vim<\/code> will execute VIM and you can then read the flag file with <code>:r \/etc\/bandit_pass\/bandit33<\/code> in vim.\n<\/p>\n<p>Thank you for reading<\/p>\n","protected":false},"excerpt":{"rendered":"<p>The last part of the Bandit challenges was relatively easy with most of the flags attainable with basic git knowledge, except for the last restricted shell escape. Try them here: OverTheWire Bandit Bandit 27-28 This is as simple as it can get at this stage. Just clone the repo and cat the README.md file. The [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[],"tags":[28,2],"class_list":["post-1066","post","type-post","status-publish","format-standard","hentry","tag-ctf","tag-linux"],"_links":{"self":[{"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/posts\/1066","targetHints":{"allow":["GET"]}}],"collection":[{"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/comments?post=1066"}],"version-history":[{"count":0,"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/posts\/1066\/revisions"}],"wp:attachment":[{"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/media?parent=1066"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/categories?post=1066"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/tags?post=1066"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}