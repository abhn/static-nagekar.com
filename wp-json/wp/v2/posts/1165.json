{"id":1165,"date":"2014-12-19T23:00:00","date_gmt":"2014-12-19T23:00:00","guid":{"rendered":"http:\/\/wp.nagekar.com\/2014\/12\/19\/creating-autocomplete-field-with-ajax\/"},"modified":"2014-12-19T23:00:00","modified_gmt":"2014-12-19T23:00:00","slug":"creating-autocomplete-field-with-ajax","status":"publish","type":"post","link":"https:\/\/nagekar.com\/2014\/12\/creating-autocomplete-field-with-ajax.html","title":{"rendered":"Creating an autocomplete field | Setting up the backend | Part 1"},"content":{"rendered":"<div dir=\"ltr\" style=\"text-align: left;\" trbidi=\"on\">\n<div dir=\"ltr\" style=\"text-align: left;\" trbidi=\"on\">\n<div style=\"text-align: left;\">Hello folks, so my exams are over and its time to roll. LOL pretty excited here. I am creating this series of two articles in which we will download all the pincodes (or zipcodes), add them to a MySQL database, write an API in PHP to retrieve the data in JSON, and finally we will write our form, in which, when we enter a pincode, we automatically get the &#8216;taluka&#8217;, &#8216;district&#8217; and &#8216;state&#8217; fields filled. So lets begin.<\/div>\n<div style=\"text-align: left;\"><\/div>\n<div style=\"text-align: left;\">(and if you are from outside India, a &#8216;<i>taluka<\/i>&#8216; is a small region, like a city)<\/div>\n<div style=\"text-align: left;\"><\/div>\n<h4 style=\"text-align: left;\">Step 1 &#8211; Getting the Pincode list<\/h4>\n<div style=\"text-align: left;\">This was my biggest concern. Where do I get a list of all the pincodes in India. I could write a script and iterate through all the possible pincodes from 100000 to 999999, but, of course, there had to be a better way (and by the way, I would have got banned by the site if I sent around a million requests in a short period of time).<\/div>\n<div style=\"text-align: left;\"><\/div>\n<div style=\"text-align: left;\">Fortunately, after some googling, I found a list here, at <a href=\"https:\/\/data.gov.in\/\">data.gov.in<\/a>, to directly download the list, click <a href=\"https:\/\/data.gov.in\/resources\/all-india-pincode-directory\/download\"><b>here<\/b><\/a>. The data is in .csv format, which is essentially a text document with some proper ordering (LOL).<\/div>\n<div style=\"text-align: left;\"><\/div>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https:\/\/www.nagekar.com\/wp-content\/uploads\/2020\/12\/pincodes.png\" imageanchor=\"1\" style=\"margin-left: 1em; margin-right: 1em;\"><img loading=\"lazy\" decoding=\"async\" border=\"0\" src=\"https:\/\/www.nagekar.com\/wp-content\/uploads\/2020\/12\/pincodes.png\" height=\"264\" width=\"640\" \/><\/a><\/div>\n<div style=\"text-align: left;\"><\/div>\n<h4 style=\"text-align: left;\">Step 2 &#8211; Setting up MySQL database<\/h4>\n<div style=\"text-align: left;\">We will now add the values to a database with will serve as our source to retrieve data in the form. I am selecting MySQL because, well, that is the only SQL I currently know (wink!). I assume you know the basics of how to create a database, and even if you don&#8217;t, you can do it easily by using the&nbsp; <a href=\"https:\/\/sourceforge.net\/projects\/phpmyadmin\/\">phpmyadmin<\/a>. It is graphical, and will get the work done.<\/p>\n<p>The columns available for inserting data are:<br \/>officename,pincode,officeType,Deliverystatus,divisionname,regionname,circlename,Taluk,Districtname,statename <\/div>\n<div style=\"text-align: left;\">I will be using only &#8216;pincode&#8217;, &#8216;Taluk&#8217;, &#8216;Districtname&#8217;, &#8216;Statename&#8217; here to avoid any unnecessary cluttering.<\/p>\n<\/div>\n<div style=\"text-align: left;\">Create a database: <i>&#8216;turnouts&#8217;<\/i><\/div>\n<div style=\"text-align: left;\">Create a table: <i>&#8216;pincode&#8217;<\/i><\/div>\n<div style=\"text-align: left;\">Create 4 columns: <i>&#8216;pincode&#8217;, &#8216;taluka&#8217;, &#8216;district&#8217;, &#8216;state&#8217; <\/i><\/div>\n<div style=\"text-align: left;\"><\/div>\n<div style=\"text-align: left;\">Needless to say, these are just names and you can have what you want, but just don&#8217;t go insane over them. This is how it should look, or similar.<\/div>\n<div style=\"text-align: left;\"><\/div>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https:\/\/www.nagekar.com\/wp-content\/uploads\/2020\/12\/mysql.png\" imageanchor=\"1\" style=\"margin-left: 1em; margin-right: 1em;\"><img loading=\"lazy\" decoding=\"async\" border=\"0\" src=\"https:\/\/www.nagekar.com\/wp-content\/uploads\/2020\/12\/mysql.png\" height=\"275\" width=\"640\" \/><\/a><\/div>\n<div style=\"text-align: left;\"><\/div>\n<div style=\"text-align: left;\"><\/div>\n<div style=\"text-align: left;\">Having done that, move to step 3.<\/div>\n<div style=\"text-align: left;\"><\/div>\n<h4 style=\"text-align: left;\">Step 3 &#8211; Writing the PHP script to enumerate database<\/h4>\n<div style=\"text-align: left;\">So now we need to fill those database fields with data. If you take a look, the .csv file that we downloaded has around 152,000 lines. We can insert them manually, but that would take two and a half month, so we are better off writing a script. Language is on you. Python would work, but I preferred PHP, no good reason, I just choose it.<\/div>\n<div style=\"text-align: left;\"><\/div>\n<div style=\"text-align: left;\">Basically we read a line in the file, select the data that we are concerned about, generate a MySQL query dynamically in a loop, and execute the query. Then move to the next line till<i> feof <\/i>or end of file.<\/div>\n<div style=\"text-align: left;\"><\/div>\n<div style=\"text-align: left;\">Here is the php code.<\/div>\n<\/div>\n<pre class=\"brush: php\">&lt;?php<br \/>\t$file = fopen(\"pincodes.csv\", \"r\") or die(\"Open file\");<br \/>\t$server = \"localhost\";<br \/>\t$username = \"root\";<br \/>\t$password = \"password\";<br \/>\t$db = \"turnouts\";<br \/>\t$conn = mysql_connect($server, $username, $password);<br \/>\tmysql_select_db(\"turnouts\") or die();<br \/>\tif(!$conn) {<br \/>\t\tdie(\"Connection failed: \" . mysqli_connect_error());<br \/>\t}<br \/>\twhile(!feof($file)) {<br \/>\t\t$line = fgets($file);<br \/>\t\t$words = explode(\",\", $line);<br \/>\t\t$pincode = $words[1];<br \/>\t\t$taluka = $words[7];<br \/>\t\t$district = $words[8];<br \/>\t\t$state = $words[9];<br \/>\t\t$sql = \"INSERT INTO pincode (pincode, taluka, district, state) VALUES ('$pincode', '$taluka', '$district', '$state')\";<br \/>\t\tmysql_query($sql, $conn);<br \/>\t\tmysql_error($conn);<br \/>\t}<br \/>\tfclose($file);<br \/>\tmysql_close($conn);<br \/>?&gt;<br \/><\/pre>\n<p>This code will take some time to execute. On my low end box, it took 90 minutes approx. After having executed, you should have a database with some real data. Here&#8217;s the row count, a whooping 154,797.<\/p>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https:\/\/www.nagekar.com\/wp-content\/uploads\/2020\/12\/count.png\" imageanchor=\"1\" style=\"margin-left: 1em; margin-right: 1em;\"><img loading=\"lazy\" decoding=\"async\" border=\"0\" src=\"https:\/\/www.nagekar.com\/wp-content\/uploads\/2020\/12\/count.png\" height=\"230\" width=\"640\" \/><\/a><\/div>\n<p>Now that we have our database setup, we are all set to write the front end. To make it easy to follow, I will write it in the second part of this series.<\/p>\n<p>Edit: <a href=\"https:\/\/www.nagekar.com\/2014\/12\/autocomplete-field-setting-up-frontend.html\" target=\"_blank\">Here is the Part 2 <\/a>Enjoy!<\/div>\n","protected":false},"excerpt":{"rendered":"<p>Hello folks, so my exams are over and its time to roll. LOL pretty excited here. I am creating this series of two articles in which we will download all the pincodes (or zipcodes), add them to a MySQL database, write an API in PHP to retrieve the data in JSON, and finally we will [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":831,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[],"tags":[21,14,24,25,23,26],"class_list":["post-1165","post","type-post","status-publish","format-standard","has-post-thumbnail","hentry","tag-html","tag-javascript","tag-jquery","tag-json","tag-mysql","tag-php"],"_links":{"self":[{"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/posts\/1165","targetHints":{"allow":["GET"]}}],"collection":[{"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/comments?post=1165"}],"version-history":[{"count":0,"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/posts\/1165\/revisions"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/media\/831"}],"wp:attachment":[{"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/media?parent=1165"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/categories?post=1165"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/nagekar.com\/wp-json\/wp\/v2\/tags?post=1165"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}